<script>
    let isFarming = false;

    // Функция для начала фарма
    function startFarm() {
        if (isFarming) return;
        isFarming = true;
        document.getElementById('farmButton').disabled = true;

        // Отправляем запрос на сервер для начала фарма
        const data = { action: 'start_farm' };
        console.log("Отправка данных в бота:", data); // Логирование
        Telegram.WebApp.sendData(JSON.stringify(data));

        // Симуляция фарма (30 секунд)
        setTimeout(() => {
            isFarming = false;
            document.getElementById('farmButton').disabled = false;
            updatePoints();
        }, 30000);
    }

    // Функция для обновления поинтов
    function updatePoints() {
        const data = { action: 'get_points' };
        console.log("Запрос поинтов:", data); // Логирование
        Telegram.WebApp.sendData(JSON.stringify(data));
    }

    // Обработка данных от бота
    Telegram.WebApp.onEvent('message', (data) => {
        console.log("Получены данные от бота:", data); // Логирование
        const message = JSON.parse(data);
        if (message.action === 'update_points') {
            document.getElementById('points').textContent = message.points;
        }
    });

    // Инициализация
    Telegram.WebApp.ready();
    updatePoints();
</script>
